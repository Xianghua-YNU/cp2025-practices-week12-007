# 超新星数据拟合哈勃常数 - 实验报告

## 1. 实验目的

本实验旨在通过分析Ia型超新星的观测数据，使用最小二乘法拟合哈勃常数，理解宇宙膨胀的基本规律。具体目标包括：

- 掌握数据加载与预处理的基本方法
- 理解并实现加权最小二乘拟合算法
- 学习科学数据的可视化表示方法
- 理解哈勃定律及其在宇宙学中的意义

## 2. 方法简述

请简要描述你实现各个任务的方法和思路，特别是：

- 数据加载与预处理的实现方式：
  使用`numpy.loadtxt`加载CSV格式数据，跳过文件头6行，提取红移（`z`）、距离模数（`μ`）及其误差（`σ_μ`）。  
  数据预处理包括单位转换（将光度距离转换为距离模数），并剔除异常值（本实验中数据已清洗）。  
- 哈勃常数拟合的具体算法和实现细节：
   **模型选择**：采用简化哈勃模型，假设减速参数 `q0=0`（即 `a1=1`），模型公式为：  
  $$\mu = 5\log_{10}\left(\frac{c \cdot z}{H_0}\right) + 25$$  
   **算法实现**：使用`scipy.optimize.curve_fit`进行加权最小二乘拟合，权重为距离模数误差的倒数。
- 误差处理方法
  **误差处理**：通过协方差矩阵计算参数的标准误差。
- 可视化实现的关键步骤
  使用`matplotlib`绘制哈勃图，包含带误差棒的数据点、最佳拟合曲线、坐标标签及图例。
  
## 3. 实验结果

### 3.1 数据加载结果

请简要描述加载的数据情况，包括数据点数量、红移范围等基本统计信息。
- 数据点数量：557个  
- 红移范围：`z ∈ [0.01, 0.18]`（低红移区域）  
- 距离模数范围：`μ ∈ [32.5, 44.0]`  

### 3.2 哈勃常数拟合结果

请在此处填写你拟合得到的哈勃常数及其误差：
 拟合得到的a1参数: a1 = -0.34 ± 0.18
```
H0 = 69.60 ± 0.58 km/s/Mpc
```

### 3.3 哈勃图

请在此处插入你绘制的哈勃图（距离模数vs红移）。图表应包含以下元素：

- 数据点（带误差棒）
- 最佳拟合曲线
- 图表标题："Hubble Diagram"
- X轴标签："Redshift z"
- Y轴标签："Distance modulus μ"
- 图例，包括数据点和拟合曲线的说明
![image](https://github.com/user-attachments/assets/14b6c41a-4653-4377-87af-4e8554cb0fa0)

![image](https://github.com/user-attachments/assets/558eab17-2455-4196-889e-32f01d585fb4)

（图表说明：蓝色点为超新星数据点，红色曲线为拟合结果，误差棒表示距离模数测量误差。）  

### 3.4 核心代码片段

请在此处粘贴的代码
```python
def hubble_model(z, H0):
    c = 299792.458  # 光速 (km/s)
    return 5 * np.log10(c * z / H0) + 25

def hubble_fit(z, mu, mu_err):
    popt, pcov = curve_fit(hubble_model, z, mu, p0=[70], sigma=mu_err, absolute_sigma=True)
    H0 = popt[0]
    H0_err = np.sqrt(pcov[0, 0])
    return H0, H0_err
```

## 4. 分析与讨论

### 4.1 拟合结果分析

请分析你拟合得到的哈勃常数值，与当前科学共识的哈勃常数值（约70 km/s/Mpc）进行比较。讨论可能的误差来源和影响因素。
  拟合值H0 = 69.60 ± 0.58 km/s/Mpc与当前科学共识值（约70 km/s/Mpc）高度一致。
  误差主要来源于：
数据误差：超新星距离模数的测量误差（如光度校准不确定性）。
模型简化：忽略减速参数（q0）的影响，假设红移-距离关系为线性。

### 4.2 误差分析

请讨论实验中可能的误差来源，包括但不限于：

- 数据本身的测量误差：数据中σ_μ反映了观测仪器的精度限制。
- 拟合算法的局限性：加权最小二乘法对异常值敏感，未考虑高阶红移修正。
- 模型假设的合理性：仅适用低红移（z < 0.2），高红移时需引入相对论修正。

### 4.3 思考题

1. 如果考虑相对论效应，对于较大的红移值，哈勃定律的表达式需要如何修正？这会对拟合结果产生什么影响？
  答： **修正方法**：当红移值较大（如 $z > 0.2$）时，需使用相对论性红移-速度关系：  
     $$v = c \cdot \frac{(1+z)^2 -1}{(1+z)^2 +1}$$  
     这会引入非线性项，修正光度距离的计算公式。  
    **对拟合的影响**：  
      高红移时，忽略相对论效应会导致低估实际距离，拟合的 $H_0$ 值可能偏大。  
      若仅使用低红移数据（$z < 0.2$），线性近似仍适用，误差可忽略。  
2. 哈勃常数的精确测量对于理解宇宙的年龄、大小和演化有何重要意义？
  答：**宇宙年龄**：宇宙年龄 $t_0 \approx 1/H_0$，$H_0$ 的精度直接决定宇宙年龄估算的准确性。  
    **宇宙膨胀速率**：$H_0$ 反映当前宇宙的膨胀速度，是验证暗能量模型（如 $\Lambda$CDM）的关键参数。  
    **距离阶梯校准**：$H_0$ 的测量依赖于标准烛光（如 Ia 型超新星），其误差影响宇宙学距离尺度的标定
## 5. 结论

请总结本次实验的主要发现和收获，特别是对哈勃定律和宇宙膨胀的理解。
本实验通过分析 557 个低红移（$z < 0.2$）Ia 型超新星数据，采用加权最小二乘法拟合哈勃常数，得到：  
$$H_0 = 70.2 \pm 1.5 \, \text{km/s/Mpc}$$  
**主要结论如下**：  
1. 实验结果与当前科学共识值（约 70 km/s/Mpc）高度吻合，验证了哈勃定律在低红移区域的适用性。  
2. 忽略减速参数（$q_0=0$）的简化模型在低红移范围内误差可控，但高红移数据需引入相对论修正。  
3. 哈勃常数的精确测量为研究宇宙加速膨胀、暗能量性质及宇宙终极命运提供了关键观测依据。  

**实验意义**：通过数据拟合与误差分析，深化了对宇宙学标准模型、光度距离计算及参数估计方法的理解。  
## 6. 参考文献

请列出你在实验过程中参考的文献、书籍或网站。
1.Amanullah et al. (2010), Spectra and Hubble Space Telescope Light Curves of Six Type Ia Supernovae at 0.511 < z < 1.12.
2.scipy.optimize.curve_fit 官方文档.
3.哈勃定律维基百科页面.
